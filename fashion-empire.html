<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fashion Empire Admin - Smart Tech OS</title>
    
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --imperial: #630d16; --oro: #d4af37; --fondo: #050505; 
            --tarjeta: rgba(26, 26, 26, 0.8); --texto: #f4f4f4; 
            --plata: #c0c0c0; --verde: #2ecc71;
        }
        
        body { 
            font-family: 'Montserrat', sans-serif; background: var(--fondo); 
            color: var(--texto); margin: 0; overflow-x: hidden;
        }

        /* --- EFECTO PASARELA (INTRO) --- */
        #intro-overlay {
            position: fixed; inset: 0; z-index: 9999; background: #000;
            display: flex; align-items: center; justify-content: center;
        }

        .curtain {
            position: absolute; width: 50%; height: 100%;
            background: linear-gradient(to right, #4a0a10, #630d16, #4a0a10);
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }
        .left-curtain { left: 0; border-right: 1px solid var(--oro); }
        .right-curtain { right: 0; border-left: 1px solid var(--oro); }

        #fashion-logo-intro {
            font-family: 'Playfair Display', serif; font-size: 3rem; color: var(--oro);
            z-index: 10000; text-align: center; opacity: 0; letter-spacing: 10px;
            text-shadow: 0 0 20px rgba(212,175,55,0.5);
        }

        /* --- CONTENEDOR PRINCIPAL --- */
        #main-content { opacity: 0; padding: 20px; max-width: 1400px; margin: auto; }

        .card { 
            background: var(--tarjeta); border: 1px solid rgba(212,175,55,0.1);
            border-radius: 15px; padding: 20px; backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 20px;
        }

        h2 { font-family: 'Playfair Display', serif; color: var(--oro); text-transform: uppercase; letter-spacing: 4px; }
        
        .stat-val { font-size: 1.8rem; font-weight: 600; color: #fff; display: block; margin-top: 5px; }
        
        /* Inputs Estilizados */
        input, select { 
            background: rgba(0,0,0,0.5); border: 1px solid #333; color: white;
            padding: 12px; border-radius: 8px; width: 100%; box-sizing: border-box;
            transition: 0.3s;
        }
        input:focus { border-color: var(--oro); outline: none; box-shadow: 0 0 10px rgba(212,175,55,0.2); }

        .btn-save { 
            background: linear-gradient(135deg, var(--imperial), #800d1a);
            color: white; border: 1px solid var(--oro); padding: 15px;
            border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%;
            letter-spacing: 2px; transition: 0.4s;
        }
        .btn-save:hover { transform: translateY(-3px); box-shadow: 0 5px 20px rgba(99,13,22,0.6); }

        /* Estilo de Tablas "Luxury" */
        table { width: 100%; border-collapse: collapse; }
        th { color: var(--oro); text-transform: uppercase; font-size: 0.7rem; padding: 15px 10px; border-bottom: 1px solid var(--imperial); }
        td { padding: 12px 10px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 0.85rem; }

        .grid-layout { display: grid; grid-template-columns: 1fr 1.5fr; gap: 20px; }
        @media (max-width: 1000px) { .grid-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body onclick="startApp()">

    <div id="intro-overlay">
        <div class="curtain left-curtain"></div>
        <div class="curtain right-curtain"></div>
        <div id="fashion-logo-intro">FASHION EMPIRE</div>
    </div>

    <div id="main-content">
        <header style="text-align: center; margin-bottom: 40px;">
            <div style="font-size: 0.7rem; letter-spacing: 5px; color: var(--oro); margin-bottom: 10px;">SMART TECH PRESENT</div>
            <h2 style="font-size: 2.5rem; margin: 0;">The Fashion Empire</h2>
            <p style="color: var(--plata); letter-spacing: 2px;">SISTEMA DE GESTIÓN DE ALTA COSTURA</p>
        </header>

        <div class="grid-layout">
            <div class="side-panel">
                <div class="card" style="border-left: 4px solid var(--oro);">
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <div style="flex:1">
                            <label style="color:var(--oro); font-size:0.7rem">CAPITAL INVERTIDO</label>
                            <span id="capInvertido" class="stat-val">$0</span>
                        </div>
                        <div style="flex:1">
                            <label style="color:var(--verde); font-size:0.7rem">VENTAS HOY</label>
                            <span id="ventasDia" class="stat-val" style="color:var(--verde)">$0</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 style="color:var(--oro); font-family:'Playfair Display'; margin-top:0">REGISTRO DE PRENDA</h3>
                    <input type="text" id="nom" placeholder="Nombre del diseño" style="margin-bottom:15px">
                    <div style="display:flex; gap:10px; margin-bottom:15px">
                        <input type="text" id="talle" placeholder="Talle">
                        <input type="text" id="color" placeholder="Color">
                    </div>
                    <div style="display:flex; gap:10px; margin-bottom:15px">
                        <input type="number" id="cos" placeholder="Costo $">
                        <input type="number" id="pre" placeholder="PVP $">
                    </div>
                    <div style="display:flex; gap:10px; margin-bottom:20px">
                        <input type="number" id="sto" placeholder="Stock">
                        <input type="text" id="cod" placeholder="SKU / Código">
                    </div>
                    <button class="btn-save" onclick="guardarPrenda()">REGISTRAR EN EMPIRE DB</button>
                </div>
            </div>

            <div class="main-panel">
                <div class="card">
                    <h3 style="color:var(--oro); font-family:'Playfair Display'; margin-top:0">INVENTARIO PREMIUM</h3>
                    <div style="max-height: 400px; overflow-y: auto;">
                        <table>
                            <thead>
                                <tr><th>PRENDA</th><th style="text-align:center">STOCK</th><th style="text-align:right">PRECIO</th></tr>
                            </thead>
                            <tbody id="cuerpoTabla"></tbody>
                        </table>
                    </div>
                </div>

                <div class="card" style="height: 300px;">
                    <canvas id="graficoVentas"></canvas>
                </div>
            </div>
        </div>
    </div>

<script>
    // --- TU LÓGICA DE SUPABASE (MANTENIDA) ---
    const SB_URL = "https://svpurpvbiujhcbiugrkh.supabase.co";
    const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN2cHVycHZiaXVqaGNiaXVncmtoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3NDgzMTUsImV4cCI6MjA4MzMyNDMxNX0.AivKJ0_N0z_4T4vLNfUcE2hepJ1XXOO8-4fSA3PJXdc";
    const _supabase = supabase.createClient(SB_URL, SB_KEY);
    
    let appIniciada = false;

    function startApp() {
        if(appIniciada) return;
        appIniciada = true;

        const tl = gsap.timeline();
        tl.to("#fashion-logo-intro", { opacity: 1, duration: 1.5, letterSpacing: "15px", ease: "power2.out" })
          .to(".left-curtain", { x: "-100%", duration: 2, ease: "power4.inOut" }, "+=0.5")
          .to(".right-curtain", { x: "100%", duration: 2, ease: "power4.inOut" }, "-=2")
          .to("#fashion-logo-intro", { opacity: 0, scale: 1.5, duration: 1, ease: "power2.in" }, "-=1.5")
          .to("#main-content", { opacity: 1, duration: 2 }, "-=0.5")
          .set("#intro-overlay", { display: "none" });

        cargarTodo();
    }

    // Mantengo tus funciones originales pero con el estilo nuevo
    async function cargarTodo() {
        const { data: productos } = await _supabase.from('productos_boutique').select('*').order('created_at', { ascending: false });
        renderizarTabla(productos || []);
        cargarVentasYGrafico();
    }

    function renderizarTabla(lista) {
        const tbody = document.getElementById('cuerpoTabla');
        tbody.innerHTML = lista.map(item => `
            <tr>
                <td><strong>${item.nombre}</strong><br><small style="color:var(--plata)">${item.talle} | ${item.color}</small></td>
                <td style="text-align: center;">
                    <span style="color: ${item.stock <= 2 ? 'var(--rojo)' : 'var(--verde)'}; font-weight: bold;">${item.stock}</span>
                </td>
                <td style="text-align: right; font-weight: bold; color: var(--oro);">$${item.precio_venta.toLocaleString()}</td>
            </tr>
        `).join('');
        actualizarMetricas(lista);
    }

    async function cargarVentasYGrafico() {
        const { data: ventas } = await _supabase.from('ventas_boutique').select('*');
        // Aquí iría tu lógica de Chart.js que ya tienes...
    }

    function actualizarMetricas(data) {
        let cap = 0; data.forEach(p => cap += (p.precio_costo * p.stock));
        document.getElementById('capInvertido').innerText = `$${cap.toLocaleString()}`;
    }

    async function guardarPrenda() {
        // Tu función original de guardado...
        Swal.fire({ title: 'ÉXITO', text: 'Prenda registrada en el imperio', icon: 'success', background: '#1a1a1a', color: '#fff' });
    }
</script>
</body>
</html>
