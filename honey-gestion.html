<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DEMO - Gesti√≥n Almac√©n Honey</title>
    
    <script src="https://unpkg.com/html5-qrcode"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <style>
        :root { --naranja: #f39c12; --amarillo: #f1c40f; --negro: #1a1a1a; --rojo: #e74c3c; --verde: #2ecc71; --azul: #2980b9; }
        
        body { font-family: sans-serif; background: var(--negro); color: white; padding: 10px; text-align: center; margin:0; overflow-x: hidden; }

        /* --- SISTEMA DE PUERTAS DE VIDRIO DE SUPERMERCADO --- */
        #gate-container {
            position: fixed; inset: 0; z-index: 9999;
            display: flex; pointer-events: none;
            background: rgba(0,0,0,0.3); /* Fondo sutil para resaltar el vidrio */
        }
        .gate-panel {
            width: 50%; height: 100%;
            /* Vidrio ahumado con desenfoque */
            background: rgba(44, 62, 80, 0.4); 
            backdrop-filter: blur(25px); 
            -webkit-backdrop-filter: blur(25px);
            display: flex; align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        /* Reflejo diagonal de luz en el vidrio */
        .gate-panel::after {
            content: ""; position: absolute; inset: 0;
            background: linear-gradient(120deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            pointer-events: none;
        }

        .gate-left { 
            justify-content: flex-end; 
            border-right: 3px solid var(--naranja);
            box-shadow: 15px 0 40px rgba(0,0,0,0.6);
        }
        .gate-right { 
            justify-content: flex-start; 
            border-left: 3px solid var(--naranja);
            box-shadow: -15px 0 40px rgba(0,0,0,0.6);
        }
        
        /* El logo HONEY ne√≥n */
        .gate-logo {
            font-size: 6rem; 
            font-weight: 900; 
            color: var(--naranja);
            text-shadow: 0 0 15px rgba(243, 156, 18, 0.8), 0 0 40px rgba(243, 156, 18, 0.4);
            font-family: 'Arial Black', sans-serif;
            letter-spacing: -4px;
            z-index: 10;
        }

        /* Ajuste de precisi√≥n para que las letras se toquen perfectamente */
        .left-text { transform: translateX(2px); } 
        .right-text { transform: translateX(-2px); }

        /* --- ESTILOS DE LA DEMO --- */
        .card { background: #2c3e50; padding: 15px; border-radius: 15px; margin-bottom: 15px; text-align: left; border: 1px solid #444; }
        input { width: 100%; padding: 10px; margin: 5px 0; border-radius: 8px; border: none; box-sizing: border-box; font-size: 1rem; background: white; color: black; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 5px; }
        .btn-scan { background: var(--amarillo); color: black; }
        .btn-save { background: var(--verde); color: white; }
        h2, h3 { color: var(--amarillo); margin: 5px 0; }
        .tabla-contenedor { overflow-x: auto; margin-top: 10px; background: #1a1a1a; border-radius: 10px; }
        .tabla-inventario { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .tabla-inventario th { background: #444; color: var(--amarillo); padding: 10px; text-align: left; }
        .tabla-inventario td { padding: 10px; border-bottom: 1px solid #333; }
        .badge-demo { background: var(--azul); color: white; padding: 5px 10px; border-radius: 10px; font-size: 0.8rem; font-weight: bold; }
    </style>
</head>
<body>

    <div id="gate-container">
        <div class="gate-panel gate-left">
            <span class="gate-logo left-text">HO</span>
        </div>
        <div class="gate-panel gate-right">
            <span class="gate-logo right-text">NEY</span>
        </div>
    </div>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
        <span class="badge-demo">MODO DEMOSTRACI√ìN</span>
    </div>

    <h2>üçØ Demo Gesti√≥n Almac√©n</h2>
    <p style="font-size: 0.8rem; color: #aaa;">Esta es una versi√≥n de prueba. Los datos son p√∫blicos.</p>
    
    <div id="reader" style="width: 100%; border-radius: 15px; overflow: hidden; border: 2px solid var(--amarillo); margin-bottom:10px;"></div>
    <button class="btn btn-scan" onclick="iniciarEscaneo()">üì∑ PROBAR ESC√ÅNER</button>

    <div class="card">
        <h3>üì¶ Editor (Prueba Guardar)</h3>
        <input type="text" id="cod" placeholder="C√≥digo de barras">
        <input type="text" id="nom" placeholder="Nombre del producto">
        <input type="number" id="pre" placeholder="Precio Venta $">
        <input type="number" id="sto" placeholder="Stock">
        <button class="btn btn-save" onclick="guardarProducto()">üíæ GUARDAR CAMBIOS</button>
    </div>

    <div class="card">
        <h3>üìã Lista de Mercader√≠a</h3>
        <div class="tabla-contenedor">
            <table class="tabla-inventario">
                <thead>
                    <tr><th>Producto</th><th>Venta</th><th>Stock</th></tr>
                </thead>
                <tbody id="cuerpo-tabla"></tbody>
            </table>
        </div>
    </div>

<script>
    // --- L√ìGICA DE APERTURA ---
    window.addEventListener('load', () => {
        const tl = gsap.timeline();
        // Las puertas se abren con una curva "Expo" para simular motores el√©ctricos de supermercado
        tl.to(".gate-left", { x: "-100%", duration: 2, ease: "expo.inOut" }, "+=0.8")
          .to(".gate-right", { x: "100%", duration: 2, ease: "expo.inOut" }, "<")
          .to("#gate-container", { display: "none" });
    });

    const SB_URL = "https://svpurpvbiujhcbiugrkh.supabase.co";
    const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN2cHVycHZiaXVqaGNiaXVncmtoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3NDgzMTUsImV4cCI6MjA4MzMyNDMxNX0.AivKJ0_N0z_4T4vLNfUcE2hepJ1XXOO8-4fSA3PJXdc";
    const _supabase = supabase.createClient(SB_URL, SB_KEY);
    
    window.onload = () => { cargarListaMercaderia(); };

    async function cargarListaMercaderia() {
        const { data } = await _supabase.from('productos_demo').select('*').order('nombre', { ascending: true });
        let html = "";
        if(data) {
            data.forEach(p => {
                html += `<tr><td>${p.nombre}</td><td>$${p.precio}</td><td>${p.stock}</td></tr>`;
            });
            document.getElementById('cuerpo-tabla').innerHTML = html;
        }
    }

    function iniciarEscaneo() {
        const scanner = new Html5Qrcode("reader");
        scanner.start({ facingMode: "environment" }, { fps: 15, qrbox: 250 }, (codigo) => {
            document.getElementById('cod').value = codigo;
            scanner.stop();
        }).catch(err => console.error(err));
    }

    async function guardarProducto() {
        const cod = document.getElementById('cod').value;
        const nom = document.getElementById('nom').value;
        const pre = document.getElementById('pre').value;
        const sto = document.getElementById('sto').value;
        
        const { error } = await _supabase.from('productos_demo').upsert({
            codigo_barras: cod || "D-" + Math.floor(Math.random()*1000),
            nombre: nom, precio: parseFloat(pre), stock: parseInt(sto) || 0
        });

        if(!error) {
            alert("‚úÖ Guardado");
            cargarListaMercaderia();
        }
    }
</script>
</body>
</html>
